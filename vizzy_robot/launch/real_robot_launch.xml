<!--
  * Main changes from ROS1 to ROS2:
  *  - 'arg' tags in substitutions are replaced with 'var' tags (not in declarations).
-->

<launch>
  <arg name="ns" default="" description="Namespace for all nodes"/>
  
  <include file="$(find-pkg-share vizzy_robot)/launch/auxiliary_vizzy_launch.py">
        <arg name="use_full_gazebo_model" value="false" />
        <arg name="use_full_hand_model" value="false" />
        <arg name="urdf_file" value="vizzy.urdf.xacro" />
        <arg name="use_yarp" value="false" />
        <arg name="disable_laser" value="false" />
        <arg name="disable_3d_sensor" value="false" />
  </include>

  <include file="$(find-pkg-share vizzy_robot)/launch/segway_base_launch.xml">
        <arg name="odom_topic" value="odometry" />
      </include>

  <include file="$(find-pkg-share vizzy_serial_interfaces)/launch/segway_battery_state_launch.xml">
      <arg name="cha_thr" value="67.75" />
  </include>
  <include file="$(find-pkg-share vizzy_serial_interfaces)/launch/battery_state_launch.xml">
      <arg name="cha_thr" value="27.25" />
  </include>
  <include file="$(find-pkg-share vizzy_serial_interfaces)/launch/battery_charging_state_launch.xml"/>
  <include file="$(find-pkg-share vizzy_serial_interfaces)/launch/batteries_state_launch.xml"/>

  <include file="$(find-pkg-share rosbridge_server)/launch/rosbridge_websocket_launch.xml">
      </include>
  
  <group>
      <let name="front_laser_frame" value="$(var tf_prefix)nav_hokuyo_laser_link"/>
      <node name="nav_hokuyo_node" pkg="urg_node" exec="urg_node" output="screen">
          <param name="serial_port" value="/dev/ttyACM1" />
          <param name="frame_id" value="$(var front_laser_frame)" />
          <param name="angle_min" value="-1.309" />
          <param name="angle_max" value="1.309" />
          <remap from="scan" to="scan" />
      </node>
  </group>

  <group>
      <let name="rear_laser_frame" value="$(var tf_prefix)nav_hokuyo_rear_laser_link"/>
      <node name="nav_hokuyo_rear_node" pkg="urg_node" exec="urg_node" output="screen">
          <param name="serial_port" value="/dev/ttyACM0" />
          <param name="frame_id" value="$(var rear_laser_frame)" />
          <param name="angle_min" value="-1.309" />
          <param name="angle_max" value="1.309" />
          <remap from="scan" to="scan_rear" />
      </node>
  </group>

</launch>