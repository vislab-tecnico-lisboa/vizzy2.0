<!--
  * Main changes from ROS1 to ROS2:
  *  - 'arg' tags in substitutions are replaced with 'var' tags (not in declarations).
  *  - 'type' attribute in node declaration is now 'exec'.
  *  - 'find' is replaced with 'find-pkg-share' in substitutions.
-->

<launch>
  <arg name="robot" default="vizzy"/>
  <arg name="navigation" default="true"/>
  <arg name="gui" default="true"/> 
  <arg name="map_frame" default="map" />
  <arg name="base_frame_id" default="base_footprint" />
  <arg name="odom_frame_id" default="odometry" />
  <arg name="map_topic" default="/map" />
  <arg name="map_file" default="isr_7th_floor_simulation.yaml" />
  <arg name="custom_obstacles" default="true" />
  <arg name="obstacles_map_file" default="mapa_piso7_NOVO_AWESOME_obst.yaml" />
  <arg name="ns" default="" />
  <arg name="use_obstacles" default="true" />
  <arg name="scan_topic_front" default="/scan" />
  <arg name="scan_topic_rear" default="/scan_rear" />

  <include file="$(find-pkg-share vizzy_robot)/launch/real_robot_launch.xml">
    <arg name="map_frame" value="$(var map_frame)" />
    <arg name="ns" value="$(var ns)" />
  </include> 

  <group if="$(var navigation)">
    <group if="$(var use_obstacles)">
      <include file="$(find-pkg-share vizzy_navigation)/launch/navigation_launch.py">
        <arg name="params_file" value="$(find-pkg-share vizzy_navigation)/config/nav2_configuration_real.yaml"/>
        <arg name="use_sim_time" value="false"/> 
        <arg name="map_yaml" value="$(find-pkg-share vizzy_navigation)/maps/$(var obstacles_map_file)"/>
        <arg name="scan_topic_front" value="$(var scan_topic_front)"/>
        <arg name="scan_topic_rear" value="$(var scan_topic_rear)"/>
      </include>
    </group>
    <group unless="$(var use_obstacles)">
      <include file="$(find-pkg-share vizzy_navigation)/launch/navigation_launch.py">
        <arg name="params_file" value="$(find-pkg-share vizzy_navigation)/config/nav2_configuration_real.yaml"/>
        <arg name="use_sim_time" value="false"/>
        <arg name="map_yaml" value="$(find-pkg-share vizzy_navigation)/maps/$(var map_file)"/>
        <arg name="scan_topic_front" value="$(var scan_topic_front)"/>
        <arg name="scan_topic_rear" value="$(var scan_topic_rear)"/>
      </include>
    </group>
  </group>
</launch>