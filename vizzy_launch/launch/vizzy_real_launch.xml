<!--
  * Main changes from ROS1 to ROS2:
  *  - 'arg' tags in substitutions are replaced with 'var' tags (not in declarations).
  *  - 'type' attribute in node declaration is now 'exec'.
  *  - 'find' is replaced with 'find-pkg-share' in substitutions.
-->

<launch>
  <arg name="robot" default="vizzy"/>
  <arg name="navigation" default="true"/>
  <arg name="slam" default="false"/>
  <arg name="gui" default="true"/> <arg name="map_frame" default="map" />
  <arg name="base_frame_id" default="base_footprint" />
  <arg name="odom_frame_id" default="odometry" />
  <arg name="map_topic" default="/map" />
  <arg name="map_file" default="mapa_piso7_NOVO_AWESOME.yaml" />
  <arg name="custom_obstacles" default="true" />
  <arg name="obstacles_map_file" default="mapa_piso7_NOVO_AWESOME_obst.yaml" />
  <arg name="ns" default="" />

  <include file="$(find-pkg-share vizzy_robot)/launch/real_robot_launch.xml">
    <arg name="map_frame" value="$(var map_frame)" />
    <arg name="ns" value="$(var ns)" />
  </include> 

  <group if="$(var navigation)">
    <node name="hokuyo_laser_filters" pkg="laser_filters" exec="scan_to_scan_filter_chain">
      <param from="$(find-pkg-share vizzy_sensors)/config/hokuyo_filters.yaml"/>
    </node>
    <node name="hokuyo_laser_filters_rear" pkg="laser_filters" exec="scan_to_scan_filter_chain">
      <param from="$(find-pkg-share vizzy_sensors)/config/hokuyo_filters.yaml" />
      <remap from="scan" to="scan_rear"/>
      <remap from="scan_filtered" to="scan_filtered_rear"/>
    </node>

    <group unless="$(var slam)">
      <include file="$(find-pkg-share vizzy_navigation)/launch/navigation_launch.py">
        <arg name="params_file" value="$(find-pkg-share vizzy_navigation)/config/nav2_configuration.yaml"/>
        <arg name="use_sim_time" value="false"/> </include>
    </group>
  </group>
</launch>